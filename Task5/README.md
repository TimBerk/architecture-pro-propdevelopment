# –ó–∞–¥–∞–Ω–∏–µ 5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç—Ä–∞—Ñ–∏–∫–æ–º –≤–Ω—É—Ç—Ä–∏ –∫–ª–∞—Å—Ç–µ—Ä–∞ Kubertnetes

–í —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–∏ –≤–∞–º –Ω—É–∂–Ω–æ —Ä–∞–∑–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ Kubernetes:

* –í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π —Å–µ—Ä–≤–∏—Å. –í —Ç–µ—Ä–º–∏–Ω–∞—Ö Kubernetes —ç—Ç–æ –ø–æ–¥ (pod). –ü—Ä–∏ —ç—Ç–æ–º –Ω—É–∂–Ω–æ –∑–∞–ø—Ä–µ—Ç–∏—Ç—å –¥—Ä—É–≥–∏–º –ø–æ–¥–∞–º —Å –Ω–∏–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–æ–≤–∞—Ç—å.
* –ù–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –∫ –Ω–æ–≤–æ–º—É —Å–µ—Ä–≤–∏—Å—É –æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–¥–æ–≤.

## –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å

–í –∫–ª–∞—Å—Ç–µ—Ä–µ, –≤–Ω—É—Ç—Ä–∏ –æ–¥–Ω–æ–≥–æ namespace, –≤–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—å —á–µ—Ç—ã—Ä–µ —Å–µ—Ä–≤–∏—Å–∞. –í –∫–∞—á–µ—Å—Ç–≤–µ —Å–∞–º–æ–≥–æ —Å–µ—Ä–≤–∏—Å–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—Ä–∞–∑ Nginx (–≤–∞–º –Ω–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å –ª–æ–≥–∏–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —ç—Ç–æ–º –∑–∞–¥–∞–Ω–∏–π).
–ù–∞–∑–Ω–∞—á—å—Ç–µ –º–µ—Ç–∫–∏ –¥–ª—è —Å–µ—Ä–≤–∏—Å–æ–≤.

–ú–µ—Ç–∫–∏ –≤—ã–ø–æ–ª–Ω—è—é—Ç —Ñ—É–Ω–∫—Ü–∏—é —Ä–æ–ª–µ–π –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞:

1. front-end
2. back-end-api
3. admin-front-end
4. admin-back-end-api

–î–ª—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è –º–µ—Ç–æ–∫ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
kubectl run front-end-app --image=nginx --labels role=front-end --expose --port 80
``` 
    
üí° –°–µ—Ä–≤–∏—Å –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å, –¥–æ–±–∞–≤–∏–≤ —Å—É—Ñ—Ñ–∏–∫—Å -app –∫ –∏–º–µ–Ω–∏ —Å–µ—Ä–≤–∏—Å–∞. –¢–∞–∫ –±—É–¥–µ—Ç –ø—Ä–æ—â–µ —Ä–∞–∑–ª–∏—á–∞—Ç—å –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ –∏ –µ–≥–æ –º–µ—Ç–∫—É.
–°–æ–∑–¥–∞–π—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏.

–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ —Ç–∞–∫, —á—Ç–æ–±—ã —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Ç—Ä–∞—Ñ–∏–∫ –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ API (`admin-back-end-api`, `back-end-api`) –∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏—Ö UI (`front-end`, `admin-front-end`).

–¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, —Å–µ—Ç–µ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏ –¥–æ–ª–∂–Ω—ã —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–µ—Ç–µ–≤–æ–π —Ç—Ä–∞—Ñ–∏–∫ –≤ –æ–±–µ —Å—Ç–æ—Ä–æ–Ω—ã –º–µ–∂–¥—É –ø–∞—Ä–æ–π —Å–µ—Ä–≤–∏—Å–æ–≤ `front-end` –∏ `back-end-api`, –∞ —Ç–∞–∫–∂–µ `admin-front-end` –∏ `admin-back-end-api`.

–°–æ—Ö—Ä–∞–Ω–∏—Ç–µ —Å–µ—Ç–µ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É –≤ —Ñ–∞–π–ª. –ú–æ–∂–µ—Ç–µ –Ω–∞–∑–≤–∞—Ç—å –µ–≥–æ `non-admin-api-allow.yaml`. –ó–∞—Ç–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç–µ —Å–µ—Ç–µ–≤—É—é –ø–æ–ª–∏—Ç–∏–∫—É, –∏—Å–ø–æ–ª—å–∑—É—è –∫–æ–º–∞–Ω–¥—É:

```bash
kubectl apply -f non-admin-api-allow.yaml
```
     
–ö–æ–≥–¥–∞ –Ω–∞—Å—Ç—Ä–æ–∏—Ç–µ –∏ –ø—Ä–∏–º–µ–Ω–∏—Ç–µ —Å–µ—Ç–µ–≤—ã–µ –ø–æ–ª–∏—Ç–∏–∫–∏, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ç—Ä–∞—Ñ–∏–∫ –µ—Å—Ç—å –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω —Ä–∞–∑—Ä–µ—à—ë–Ω, –Ω–æ –µ–≥–æ –Ω–µ—Ç –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω –∑–∞–ø—Ä–µ—â—ë–Ω. –î–ª—è —ç—Ç–æ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:

```bash
kubectl run test-$RANDOM --rm -i -t --image=alpine -- sh
/ # wget -qO- --timeout=2 http://apiserver
```

–î–ª—è —É–ø—Ä–æ—â–µ–Ω–∏—è —Ä–∞–±–æ—Ç—ã —Å–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `run.sh`.